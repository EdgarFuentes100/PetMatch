@model List<Mensaje>

<input type="hidden" id="userIdHidden" value="@User.FindFirst("UserId")?.Value" />

<div class="container my-4">
    <h2>Mis chats recientes</h2>
    @if (!Model.Any())
    {
        <p>No tienes mensajes aún.</p>
    }
    else
    {
        <ul class="list-group" id="lista-chats">
            @foreach (var mensaje in Model)
            {
                var otroUsuario = mensaje.EmisorId == int.Parse(User.FindFirst("UserId").Value)
                ? mensaje.Receptor
                : mensaje.Emisor;

                bool noLeido = mensaje.ReceptorId == int.Parse(User.FindFirst("UserId").Value) && !mensaje.Leido;

                <li class="list-group-item d-flex justify-content-between align-items-center @(noLeido ? "fw-bold" : "")" data-id="@otroUsuario.UsuarioId">
                    <div>
                        <strong>@otroUsuario.Nombre</strong><br />
                        <small class="text-muted">@mensaje.Contenido</small>
                    </div>
                    <a class="btn btn-sm btn-primary abrir-chat" data-id="@otroUsuario.UsuarioId" data-nombre="@otroUsuario.Nombre">
                        <i class="bi bi-chat-dots"></i> Abrir chat
                    </a>
                </li>
            }
        </ul>
    }
</div>

<!-- Modal del chat (asumiendo que ya lo tienes) -->
@Html.Partial("_ModalChat")
